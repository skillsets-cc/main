# data.ts

## Purpose
Provides read-only access to the skillsets registry via the build-time generated `search-index.json`. Acts as a data layer abstraction for retrieving skillsets, tags, and metadata without directly querying the GitHub repository at runtime.

## Public API
| Export | Type | Description |
|--------|------|-------------|
| `getSkillsets` | function | Return all skillsets sorted by stars (descending) |
| `getSkillsetById` | function | Find a specific skillset by ID, return undefined if not found |
| `getAllTags` | function | Extract unique tags from all skillsets, return sorted array |
| `getSearchIndexMeta` | function | Return index metadata (version, generatedAt timestamp) |

## Dependencies
- **Internal**:
  - `@/types` (SearchIndex, SearchIndexEntry interfaces)
  - `../../public/search-index.json` (build-time static import)
- **External**: None

## Integration Points
- **Used by**:
  - `pages/index.astro` (list all skillsets)
  - `pages/browse.astro` (filterable skillset list)
  - `pages/skillset/[namespace]/[name].astro` (fetch individual skillset)
  - `components/TagFilter.tsx` (populate tag filter options)
- **Consumes**:
  - `search-index.json` (generated by build process from `skillsets/` folder)

## Key Logic

### Build-Time Data Loading
- Imports `search-index.json` as a static module (bundled at build time)
- No runtime GitHub API calls (reduces rate limits, improves performance)
- Index is immutable once deployed (requires rebuild to update)

### Sorting Strategy
- Default sort: stars descending (most popular first)
- Sorting happens in-memory on every `getSkillsets()` call
- No caching (index is small, sorting is fast)

### Tag Aggregation
- Iterates through all skillsets to collect tags
- Uses `Set` for deduplication
- Returns alphabetically sorted array
